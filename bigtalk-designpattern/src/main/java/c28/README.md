这里关键就在于人就只分为男人和女人，这个性别的分类是稳定的，所以可以
在状态类中，增加男人反应和女人反应两个方法，方法个数是稳定的，
不会很容易的发生变化。而人抽象类中有一个抽象方法接受，它是用来获得
状态对象的。每一种具体状态都继承状态抽象类，实现两个反应的方法。

双分派意味着得到执行的操作决定于请求的种类和两个接收者的类型。
接受方法就是一个双分派的操作。它得到执行的操作不仅决定于状态类的具体
状态，还决定于它访问的人的类别。

由于用了双分派，使得只需要增加一个状态子类，就可以在客户端调用来
查看，不需要改动其他任何类的代码。

完美的体现了开放-封闭原则，这种模式叫做访问者模式。

![person](https://github.com/leihenqingze/fodder/blob/master/demo-designpattern/bigtalk-designpattern/c28/person.png?raw=true)

访问者模式：表示一个作用于某对象结构中的各元素的操作。它使你可以在不
改变各元素的类的前提下定义作用于这些元素的新操作。

访问者模式适用于数据结构相对稳定的系统，如果数据结构不稳定，那就意味
访问者类中的抽象方法就不可能稳定了，每加一种类别，就需要在状态类和它
的所有下属类中都增加一个方法，这就不符合开闭原则。

它把数据结构和作用于结构上的操作之间的耦合解脱开，使得操作集合可以相对
自由地演化。

访问者模式的目的是要把处理从数据结构分离出来。很多系统可以按照算法和
数据结构分开，如果这样的系统有比较稳定的数据结构，又有易于变化的算法
的话，使用访问者模式就是比较合适的，因为访问者模式使得算法操作的增加
变得容易。经常要有新的数据对象增加进来，就不适合使用访问者模式。

优点：
访问者模式的优点就是增加新的操作很容易，因为增加新的操作就意味着增加
一个新的访问者。访问者模式将有关的行为集中到一个访问者对象中。

缺点：
使增加新的数据结构变得困难了。

通常ConcreteVisitor可以单独开发，不必跟ConcreteElementA或ConcreteElementB
写在一起。正因为这样，ConcreteVisitor能提高ConcreteElement之间的独立性，
如果把一个处理动作设计成ConcreteElementA或ConcreteElementB类的方法，每次
新增"处理"以扩充功能时就得去修改ConcreteElementA或ConcreteElementB了。
造成处理方法和数据结构的紧耦合

GoF四人中的一个作者增经说过，'大多时候你并不需要访问者模式，但当
一旦你需要访问者模式的时候，那就是真的需要它了。'
事实上，我们很难找到数据结构不变化的情况，所以用访问者模式的机会
也就不多了。

访问者模式的能力和复杂性是把双刃剑，只有当你真正需要它的时候，
才考虑使用它。有很多的程序员为了展示自己的面向对象的能力或是沉迷于
模式当中，往往会误用这个模式，所以一定要好好理解它的适用性。

我们大多数人不去用它的原因是因为它太过于复杂和晦涩，根本不能理解，
不熟悉的东西当然就不会想着去应用它了。

![访问者模式](https://github.com/leihenqingze/fodder/blob/master/demo-designpattern/bigtalk-designpattern/c28/visitor.png?raw=true)